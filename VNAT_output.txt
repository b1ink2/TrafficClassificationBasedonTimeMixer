Args in experiment:
Namespace(task_name='classification', is_training=1, model_id='classification_vpn-vnat-m.csv', model='TimeMixer', data='custom', root_path='./dataset/', data_path='vpn-vnat-m.csv', features='MS', target='Label', freq='h', checkpoints='./checkpoints/', seq_len=48, label_len=0, pred_len=0, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=76, dec_in=76, c_out=1, d_model=128, n_heads=8, e_layers=5, d_layers=2, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=0, decomp_method='moving_avg', use_norm=0, down_sampling_layers=1, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=10, learning_rate=0.003, des='Exp', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
train 30333
val 6463
test 6463
>>>>>>>start training : classification_classification_vpn-vnat-m.csv_none_TimeMixer_custom_sl48_pl0_dm128_nh8_el5_dl2_df256_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 100, epoch: 1 | loss: 1.3360045
	speed: 0.1031s/iter; left time: 1942.9322s
	iters: 200, epoch: 1 | loss: 1.1220000
	speed: 0.0403s/iter; left time: 756.0871s
	iters: 300, epoch: 1 | loss: 1.3057660
	speed: 0.0412s/iter; left time: 768.9370s
	iters: 400, epoch: 1 | loss: 1.3112487
	speed: 0.0402s/iter; left time: 745.6873s
	iters: 500, epoch: 1 | loss: 1.5080550
	speed: 0.0405s/iter; left time: 746.4504s
	iters: 600, epoch: 1 | loss: 1.0355127
	speed: 0.0397s/iter; left time: 728.8935s
	iters: 700, epoch: 1 | loss: 0.8365214
	speed: 0.0327s/iter; left time: 597.5858s
	iters: 800, epoch: 1 | loss: 0.8704565
	speed: 0.0314s/iter; left time: 570.6954s
	iters: 900, epoch: 1 | loss: 0.9931566
	speed: 0.0321s/iter; left time: 579.9342s
	iters: 1000, epoch: 1 | loss: 0.6535997
	speed: 0.0295s/iter; left time: 529.8357s
	iters: 1100, epoch: 1 | loss: 0.7046379
	speed: 0.0294s/iter; left time: 525.5932s
	iters: 1200, epoch: 1 | loss: 0.2604631
	speed: 0.0294s/iter; left time: 521.1293s
	iters: 1300, epoch: 1 | loss: 0.2125904
	speed: 0.0294s/iter; left time: 518.9655s
	iters: 1400, epoch: 1 | loss: 0.6785222
	speed: 0.0301s/iter; left time: 528.8910s
	iters: 1500, epoch: 1 | loss: 1.2136174
	speed: 0.0355s/iter; left time: 620.1902s
	iters: 1600, epoch: 1 | loss: 0.1692049
	speed: 0.0311s/iter; left time: 539.1386s
	iters: 1700, epoch: 1 | loss: 0.2261498
	speed: 0.0304s/iter; left time: 524.8328s
	iters: 1800, epoch: 1 | loss: 0.3689701
	speed: 0.0339s/iter; left time: 581.4262s
Epoch: 1 cost time: 65.93708920478821
Epoch: 1, Steps: 1895 | Train Loss: 0.831 Vali Loss: 0.414 Vali Acc: 0.864 Test Loss: 0.380 Test Acc: 0.868
Validation loss decreased (inf --> -0.868176).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5459629
	speed: 0.1957s/iter; left time: 3317.6310s
	iters: 200, epoch: 2 | loss: 0.1483415
	speed: 0.0412s/iter; left time: 694.0970s
	iters: 300, epoch: 2 | loss: 0.2992103
	speed: 0.0427s/iter; left time: 714.9852s
	iters: 400, epoch: 2 | loss: 0.6416970
	speed: 0.0405s/iter; left time: 673.9850s
	iters: 500, epoch: 2 | loss: 0.2672305
	speed: 0.0386s/iter; left time: 639.1848s
	iters: 600, epoch: 2 | loss: 0.2849432
	speed: 0.0344s/iter; left time: 565.4246s
	iters: 700, epoch: 2 | loss: 0.2571572
	speed: 0.0403s/iter; left time: 659.1562s
	iters: 800, epoch: 2 | loss: 0.6190606
	speed: 0.0441s/iter; left time: 716.8071s
	iters: 900, epoch: 2 | loss: 0.2542078
	speed: 0.0444s/iter; left time: 716.8681s
	iters: 1000, epoch: 2 | loss: 0.1875776
	speed: 0.0448s/iter; left time: 719.2501s
	iters: 1100, epoch: 2 | loss: 0.1247993
	speed: 0.0453s/iter; left time: 722.4833s
	iters: 1200, epoch: 2 | loss: 0.0936085
	speed: 0.0410s/iter; left time: 649.6555s
	iters: 1300, epoch: 2 | loss: 0.4459021
	speed: 0.0426s/iter; left time: 670.9501s
	iters: 1400, epoch: 2 | loss: 0.4759972
	speed: 0.0453s/iter; left time: 708.6184s
	iters: 1500, epoch: 2 | loss: 0.1108856
	speed: 0.0380s/iter; left time: 591.2790s
	iters: 1600, epoch: 2 | loss: 0.3523067
	speed: 0.0326s/iter; left time: 504.3959s
	iters: 1700, epoch: 2 | loss: 0.0297573
	speed: 0.0340s/iter; left time: 521.9177s
	iters: 1800, epoch: 2 | loss: 0.2939052
	speed: 0.0389s/iter; left time: 593.4741s
Epoch: 2 cost time: 77.81243205070496
Epoch: 2, Steps: 1895 | Train Loss: 0.330 Vali Loss: 0.251 Vali Acc: 0.929 Test Loss: 0.233 Test Acc: 0.934
Validation loss decreased (-0.868176 --> -0.933778).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2880274
	speed: 0.2178s/iter; left time: 3280.3985s
	iters: 200, epoch: 3 | loss: 0.1245029
	speed: 0.0477s/iter; left time: 712.9960s
	iters: 300, epoch: 3 | loss: 0.4105791
	speed: 0.0415s/iter; left time: 617.2373s
	iters: 400, epoch: 3 | loss: 0.2565411
	speed: 0.0399s/iter; left time: 588.7383s
	iters: 500, epoch: 3 | loss: 0.2144570
	speed: 0.0392s/iter; left time: 575.2299s
	iters: 600, epoch: 3 | loss: 0.3629202
	speed: 0.0400s/iter; left time: 581.7871s
	iters: 700, epoch: 3 | loss: 0.2698105
	speed: 0.0378s/iter; left time: 546.7296s
	iters: 800, epoch: 3 | loss: 0.0226048
	speed: 0.0343s/iter; left time: 492.7135s
	iters: 900, epoch: 3 | loss: 0.2018208
	speed: 0.0374s/iter; left time: 534.0552s
	iters: 1000, epoch: 3 | loss: 0.4598509
	speed: 0.0439s/iter; left time: 621.4840s
	iters: 1100, epoch: 3 | loss: 0.1041579
	speed: 0.0460s/iter; left time: 646.8625s
	iters: 1200, epoch: 3 | loss: 0.0275046
	speed: 0.0419s/iter; left time: 584.9279s
	iters: 1300, epoch: 3 | loss: 0.0140265
	speed: 0.0427s/iter; left time: 592.0886s
	iters: 1400, epoch: 3 | loss: 0.0143563
	speed: 0.0405s/iter; left time: 557.9917s
	iters: 1500, epoch: 3 | loss: 0.7144629
	speed: 0.0334s/iter; left time: 456.4956s
	iters: 1600, epoch: 3 | loss: 0.0556358
	speed: 0.0364s/iter; left time: 494.2175s
	iters: 1700, epoch: 3 | loss: 0.0393994
	speed: 0.0396s/iter; left time: 533.3408s
	iters: 1800, epoch: 3 | loss: 0.5586325
	speed: 0.0413s/iter; left time: 552.2977s
Epoch: 3 cost time: 77.67778468132019
Epoch: 3, Steps: 1895 | Train Loss: 0.209 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.933778 --> -0.957196).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0163164
	speed: 0.2168s/iter; left time: 2854.5529s
	iters: 200, epoch: 4 | loss: 0.2499511
	speed: 0.0377s/iter; left time: 492.7577s
	iters: 300, epoch: 4 | loss: 0.0302686
	speed: 0.0363s/iter; left time: 470.7494s
	iters: 400, epoch: 4 | loss: 0.0277157
	speed: 0.0355s/iter; left time: 457.1417s
	iters: 500, epoch: 4 | loss: 0.0707411
	speed: 0.0317s/iter; left time: 404.1485s
	iters: 600, epoch: 4 | loss: 0.0602895
	speed: 0.0339s/iter; left time: 429.3467s
	iters: 700, epoch: 4 | loss: 0.9663414
	speed: 0.0365s/iter; left time: 458.5892s
	iters: 800, epoch: 4 | loss: 0.0207750
	speed: 0.0399s/iter; left time: 496.9902s
	iters: 900, epoch: 4 | loss: 0.0100631
	speed: 0.0373s/iter; left time: 461.0684s
	iters: 1000, epoch: 4 | loss: 0.0704684
	speed: 0.0364s/iter; left time: 446.9043s
	iters: 1100, epoch: 4 | loss: 0.0629917
	speed: 0.0358s/iter; left time: 435.9708s
	iters: 1200, epoch: 4 | loss: 0.0255437
	speed: 0.0364s/iter; left time: 439.5938s
	iters: 1300, epoch: 4 | loss: 0.0830102
	speed: 0.0452s/iter; left time: 540.5480s
	iters: 1400, epoch: 4 | loss: 0.5860060
	speed: 0.0500s/iter; left time: 593.4533s
	iters: 1500, epoch: 4 | loss: 0.2107986
	speed: 0.0372s/iter; left time: 437.5632s
	iters: 1600, epoch: 4 | loss: 0.0802254
	speed: 0.0382s/iter; left time: 445.1454s
	iters: 1700, epoch: 4 | loss: 0.1597347
	speed: 0.0396s/iter; left time: 458.5123s
	iters: 1800, epoch: 4 | loss: 0.1364355
	speed: 0.0345s/iter; left time: 395.9463s
Epoch: 4 cost time: 72.68656086921692
Epoch: 4, Steps: 1895 | Train Loss: 0.145 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.957196 --> -0.970689).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0136300
	speed: 0.1979s/iter; left time: 2230.1048s
	iters: 200, epoch: 5 | loss: 0.0714182
	speed: 0.0486s/iter; left time: 543.2616s
	iters: 300, epoch: 5 | loss: 0.3074401
	speed: 0.0333s/iter; left time: 369.2008s
	iters: 400, epoch: 5 | loss: 0.0556838
	speed: 0.0451s/iter; left time: 494.4742s
	iters: 500, epoch: 5 | loss: 0.0076580
	speed: 0.0454s/iter; left time: 494.0846s
	iters: 600, epoch: 5 | loss: 0.0095757
	speed: 0.0354s/iter; left time: 381.4544s
	iters: 700, epoch: 5 | loss: 0.3540842
	speed: 0.0354s/iter; left time: 378.1862s
	iters: 800, epoch: 5 | loss: 0.0138013
	speed: 0.0343s/iter; left time: 362.7370s
	iters: 900, epoch: 5 | loss: 0.0908369
	speed: 0.0394s/iter; left time: 412.7293s
	iters: 1000, epoch: 5 | loss: 0.0832789
	speed: 0.0392s/iter; left time: 406.9878s
	iters: 1100, epoch: 5 | loss: 0.8188744
	speed: 0.0443s/iter; left time: 455.0578s
	iters: 1200, epoch: 5 | loss: 0.0013460
	speed: 0.0491s/iter; left time: 499.6770s
	iters: 1300, epoch: 5 | loss: 0.0344968
	speed: 0.0450s/iter; left time: 453.2344s
	iters: 1400, epoch: 5 | loss: 0.0885248
	speed: 0.0404s/iter; left time: 402.6860s
	iters: 1500, epoch: 5 | loss: 0.0080396
	speed: 0.0324s/iter; left time: 320.0607s
	iters: 1600, epoch: 5 | loss: 0.0319270
	speed: 0.0337s/iter; left time: 329.2154s
	iters: 1700, epoch: 5 | loss: 0.0559687
	speed: 0.0362s/iter; left time: 350.0001s
	iters: 1800, epoch: 5 | loss: 0.0016054
	speed: 0.0315s/iter; left time: 301.4112s
Epoch: 5 cost time: 74.93974876403809
Epoch: 5, Steps: 1895 | Train Loss: 0.114 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.972
Validation loss decreased (-0.970689 --> -0.971619).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2478806
	speed: 0.1912s/iter; left time: 1792.5844s
	iters: 200, epoch: 6 | loss: 0.0456236
	speed: 0.0388s/iter; left time: 359.5928s
	iters: 300, epoch: 6 | loss: 0.0138870
	speed: 0.0322s/iter; left time: 295.6338s
	iters: 400, epoch: 6 | loss: 0.0012978
	speed: 0.0383s/iter; left time: 347.7689s
	iters: 500, epoch: 6 | loss: 0.0020255
	speed: 0.0424s/iter; left time: 380.9599s
	iters: 600, epoch: 6 | loss: 0.0179925
	speed: 0.0388s/iter; left time: 344.6592s
	iters: 700, epoch: 6 | loss: 0.0095583
	speed: 0.0391s/iter; left time: 343.0710s
	iters: 800, epoch: 6 | loss: 0.6708035
	speed: 0.0392s/iter; left time: 340.1532s
	iters: 900, epoch: 6 | loss: 0.0119022
	speed: 0.0365s/iter; left time: 313.3757s
	iters: 1000, epoch: 6 | loss: 0.0203231
	speed: 0.0367s/iter; left time: 311.2335s
	iters: 1100, epoch: 6 | loss: 0.0010965
	speed: 0.0349s/iter; left time: 292.2644s
	iters: 1200, epoch: 6 | loss: 0.0085319
	speed: 0.0379s/iter; left time: 313.7865s
	iters: 1300, epoch: 6 | loss: 0.0373963
	speed: 0.0382s/iter; left time: 311.9177s
	iters: 1400, epoch: 6 | loss: 0.0030423
	speed: 0.0408s/iter; left time: 329.2020s
	iters: 1500, epoch: 6 | loss: 0.0006468
	speed: 0.0404s/iter; left time: 322.0420s
	iters: 1600, epoch: 6 | loss: 0.1664363
	speed: 0.0391s/iter; left time: 307.6483s
	iters: 1700, epoch: 6 | loss: 0.0410737
	speed: 0.0360s/iter; left time: 279.8800s
	iters: 1800, epoch: 6 | loss: 0.0705568
	speed: 0.0355s/iter; left time: 272.1837s
Epoch: 6 cost time: 72.2857084274292
Epoch: 6, Steps: 1895 | Train Loss: 0.093 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.971619 --> -0.979994).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.3610764
	speed: 0.2122s/iter; left time: 1587.4787s
	iters: 200, epoch: 7 | loss: 0.0193907
	speed: 0.0489s/iter; left time: 360.5697s
	iters: 300, epoch: 7 | loss: 0.0213391
	speed: 0.0481s/iter; left time: 350.3322s
	iters: 400, epoch: 7 | loss: 0.0594935
	speed: 0.0446s/iter; left time: 319.9221s
	iters: 500, epoch: 7 | loss: 0.0071051
	speed: 0.0514s/iter; left time: 364.2509s
	iters: 600, epoch: 7 | loss: 0.3813435
	speed: 0.0498s/iter; left time: 347.4795s
	iters: 700, epoch: 7 | loss: 0.0291833
	speed: 0.0488s/iter; left time: 336.0697s
	iters: 800, epoch: 7 | loss: 0.0033984
	speed: 0.0470s/iter; left time: 318.4254s
	iters: 900, epoch: 7 | loss: 0.1068933
	speed: 0.0530s/iter; left time: 353.8304s
	iters: 1000, epoch: 7 | loss: 0.0468953
	speed: 0.0462s/iter; left time: 304.1028s
	iters: 1100, epoch: 7 | loss: 0.0196599
	speed: 0.0367s/iter; left time: 237.8153s
	iters: 1200, epoch: 7 | loss: 0.2424003
	speed: 0.0393s/iter; left time: 250.9095s
	iters: 1300, epoch: 7 | loss: 0.0035789
	speed: 0.0455s/iter; left time: 286.0602s
	iters: 1400, epoch: 7 | loss: 0.0070198
	speed: 0.0404s/iter; left time: 249.7238s
	iters: 1500, epoch: 7 | loss: 0.0212638
	speed: 0.0393s/iter; left time: 239.0982s
	iters: 1600, epoch: 7 | loss: 0.0917408
	speed: 0.0338s/iter; left time: 202.3910s
	iters: 1700, epoch: 7 | loss: 0.0036137
	speed: 0.0358s/iter; left time: 210.6388s
	iters: 1800, epoch: 7 | loss: 0.0013274
	speed: 0.0424s/iter; left time: 245.1921s
Epoch: 7 cost time: 83.94154334068298
Epoch: 7, Steps: 1895 | Train Loss: 0.084 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0156474
	speed: 0.2065s/iter; left time: 1153.7415s
	iters: 200, epoch: 8 | loss: 0.0091600
	speed: 0.0529s/iter; left time: 289.9369s
	iters: 300, epoch: 8 | loss: 0.0146233
	speed: 0.0494s/iter; left time: 266.0131s
	iters: 400, epoch: 8 | loss: 0.0331813
	speed: 0.0473s/iter; left time: 249.7992s
	iters: 500, epoch: 8 | loss: 0.0184594
	speed: 0.0420s/iter; left time: 217.6491s
	iters: 600, epoch: 8 | loss: 0.0010627
	speed: 0.0372s/iter; left time: 189.2966s
	iters: 700, epoch: 8 | loss: 0.0065316
	speed: 0.0431s/iter; left time: 214.7625s
	iters: 800, epoch: 8 | loss: 0.0019151
	speed: 0.0400s/iter; left time: 195.4964s
	iters: 900, epoch: 8 | loss: 0.0045388
	speed: 0.0378s/iter; left time: 180.9823s
	iters: 1000, epoch: 8 | loss: 0.0075431
	speed: 0.0341s/iter; left time: 159.6296s
	iters: 1100, epoch: 8 | loss: 0.0731757
	speed: 0.0366s/iter; left time: 167.7721s
	iters: 1200, epoch: 8 | loss: 0.5253671
	speed: 0.0353s/iter; left time: 158.3650s
	iters: 1300, epoch: 8 | loss: 0.4690623
	speed: 0.0440s/iter; left time: 192.9364s
	iters: 1400, epoch: 8 | loss: 0.3030173
	speed: 0.0432s/iter; left time: 184.9572s
	iters: 1500, epoch: 8 | loss: 0.0020877
	speed: 0.0415s/iter; left time: 173.5285s
	iters: 1600, epoch: 8 | loss: 0.0013654
	speed: 0.0431s/iter; left time: 176.1818s
	iters: 1700, epoch: 8 | loss: 0.0629924
	speed: 0.0351s/iter; left time: 139.7509s
	iters: 1800, epoch: 8 | loss: 0.1171449
	speed: 0.0404s/iter; left time: 157.0980s
Epoch: 8 cost time: 79.33538150787354
Epoch: 8, Steps: 1895 | Train Loss: 0.071 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0069638
	speed: 0.2075s/iter; left time: 765.7385s
	iters: 200, epoch: 9 | loss: 0.0404456
	speed: 0.0415s/iter; left time: 148.9775s
	iters: 300, epoch: 9 | loss: 0.0165689
	speed: 0.0355s/iter; left time: 123.9658s
	iters: 400, epoch: 9 | loss: 0.0041434
	speed: 0.0338s/iter; left time: 114.6373s
	iters: 500, epoch: 9 | loss: 0.0115957
	speed: 0.0361s/iter; left time: 118.8262s
	iters: 600, epoch: 9 | loss: 0.0509168
	speed: 0.0319s/iter; left time: 101.8153s
	iters: 700, epoch: 9 | loss: 0.0212043
	speed: 0.0315s/iter; left time: 97.3470s
	iters: 800, epoch: 9 | loss: 0.0474690
	speed: 0.0360s/iter; left time: 107.6655s
	iters: 900, epoch: 9 | loss: 0.0008358
	speed: 0.0431s/iter; left time: 124.5113s
	iters: 1000, epoch: 9 | loss: 0.0055768
	speed: 0.0346s/iter; left time: 96.5303s
	iters: 1100, epoch: 9 | loss: 0.0194556
	speed: 0.0320s/iter; left time: 86.2314s
	iters: 1200, epoch: 9 | loss: 0.1144843
	speed: 0.0316s/iter; left time: 81.9687s
	iters: 1300, epoch: 9 | loss: 0.3460954
	speed: 0.0333s/iter; left time: 82.9821s
	iters: 1400, epoch: 9 | loss: 0.0062283
	speed: 0.0360s/iter; left time: 86.0289s
	iters: 1500, epoch: 9 | loss: 0.0036132
	speed: 0.0330s/iter; left time: 75.6281s
	iters: 1600, epoch: 9 | loss: 0.0008635
	speed: 0.0395s/iter; left time: 86.5714s
	iters: 1700, epoch: 9 | loss: 0.0894154
	speed: 0.0328s/iter; left time: 68.6526s
	iters: 1800, epoch: 9 | loss: 0.0143105
	speed: 0.0340s/iter; left time: 67.6707s
Epoch: 9 cost time: 67.67043137550354
Epoch: 9, Steps: 1895 | Train Loss: 0.066 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0187116
	speed: 0.2104s/iter; left time: 377.8146s
	iters: 200, epoch: 10 | loss: 0.0415238
	speed: 0.0459s/iter; left time: 77.7852s
	iters: 300, epoch: 10 | loss: 0.0012323
	speed: 0.0415s/iter; left time: 66.2707s
	iters: 400, epoch: 10 | loss: 0.0006950
	speed: 0.0380s/iter; left time: 56.8020s
	iters: 500, epoch: 10 | loss: 0.0181453
	speed: 0.0469s/iter; left time: 65.4767s
	iters: 600, epoch: 10 | loss: 0.2569976
	speed: 0.0451s/iter; left time: 58.4248s
	iters: 700, epoch: 10 | loss: 0.0064610
	speed: 0.0382s/iter; left time: 45.7252s
	iters: 800, epoch: 10 | loss: 0.0039930
	speed: 0.0515s/iter; left time: 56.4692s
	iters: 900, epoch: 10 | loss: 0.0008333
	speed: 0.0492s/iter; left time: 49.0062s
	iters: 1000, epoch: 10 | loss: 0.1245907
	speed: 0.0477s/iter; left time: 42.7412s
	iters: 1100, epoch: 10 | loss: 0.0023522
	speed: 0.0443s/iter; left time: 35.2230s
	iters: 1200, epoch: 10 | loss: 0.2393629
	speed: 0.0430s/iter; left time: 29.9391s
	iters: 1300, epoch: 10 | loss: 0.0044706
	speed: 0.0411s/iter; left time: 24.4892s
	iters: 1400, epoch: 10 | loss: 0.0017202
	speed: 0.0391s/iter; left time: 19.4109s
	iters: 1500, epoch: 10 | loss: 0.0060415
	speed: 0.0457s/iter; left time: 18.0924s
	iters: 1600, epoch: 10 | loss: 0.0017726
	speed: 0.0356s/iter; left time: 10.5347s
	iters: 1700, epoch: 10 | loss: 0.0051820
	speed: 0.0417s/iter; left time: 8.1779s
	iters: 1800, epoch: 10 | loss: 0.0064027
	speed: 0.0466s/iter; left time: 4.4698s
Epoch: 10 cost time: 82.65274572372437
Epoch: 10, Steps: 1895 | Train Loss: 0.056 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_classification_vpn-vnat-m.csv_none_TimeMixer_custom_sl48_pl0_dm128_nh8_el5_dl2_df256_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test shape: torch.Size([6448, 5]) torch.Size([6448])
accuracy:0.9799937965260546, precision:0.9799349727346283, recall:0.9799937965260546, f1:0.9799467267707812
Args in experiment:
Namespace(task_name='classification', is_training=1, model_id='classification_vpn-vnat-m.csv', model='TimeMixer', data='custom', root_path='./dataset/', data_path='vpn-vnat-m.csv', features='MS', target='Label', freq='h', checkpoints='./checkpoints/', seq_len=192, label_len=0, pred_len=0, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=76, dec_in=76, c_out=1, d_model=128, n_heads=8, e_layers=5, d_layers=2, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=0, decomp_method='moving_avg', use_norm=0, down_sampling_layers=1, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=10, learning_rate=0.003, des='Exp', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
train 30189
val 6319
test 6319
>>>>>>>start training : classification_classification_vpn-vnat-m.csv_none_TimeMixer_custom_sl192_pl0_dm128_nh8_el5_dl2_df256_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 100, epoch: 1 | loss: 0.9205008
	speed: 0.0976s/iter; left time: 1830.1937s
	iters: 200, epoch: 1 | loss: 1.4830317
	speed: 0.0399s/iter; left time: 744.3370s
	iters: 300, epoch: 1 | loss: 1.3143883
	speed: 0.0408s/iter; left time: 757.5913s
	iters: 400, epoch: 1 | loss: 1.3196326
	speed: 0.0425s/iter; left time: 785.5061s
	iters: 500, epoch: 1 | loss: 1.3017356
	speed: 0.0393s/iter; left time: 720.9247s
	iters: 600, epoch: 1 | loss: 1.1800703
	speed: 0.0512s/iter; left time: 934.4016s
	iters: 700, epoch: 1 | loss: 1.1346999
	speed: 0.0468s/iter; left time: 849.6987s
	iters: 800, epoch: 1 | loss: 1.1918060
	speed: 0.0421s/iter; left time: 760.1034s
	iters: 900, epoch: 1 | loss: 0.8554869
	speed: 0.0423s/iter; left time: 760.6122s
	iters: 1000, epoch: 1 | loss: 0.9009416
	speed: 0.0337s/iter; left time: 601.7211s
	iters: 1100, epoch: 1 | loss: 0.5030017
	speed: 0.0434s/iter; left time: 771.0688s
	iters: 1200, epoch: 1 | loss: 0.7661095
	speed: 0.0409s/iter; left time: 722.1234s
	iters: 1300, epoch: 1 | loss: 0.3601246
	speed: 0.0443s/iter; left time: 777.7135s
	iters: 1400, epoch: 1 | loss: 0.3786799
	speed: 0.0461s/iter; left time: 805.2027s
	iters: 1500, epoch: 1 | loss: 0.3294677
	speed: 0.0451s/iter; left time: 782.3844s
	iters: 1600, epoch: 1 | loss: 0.5573818
	speed: 0.0390s/iter; left time: 673.5441s
	iters: 1700, epoch: 1 | loss: 0.3158067
	speed: 0.0441s/iter; left time: 756.4853s
	iters: 1800, epoch: 1 | loss: 0.2085861
	speed: 0.0372s/iter; left time: 635.4765s
Epoch: 1 cost time: 80.34102082252502
Epoch: 1, Steps: 1886 | Train Loss: 0.853 Vali Loss: 0.374 Vali Acc: 0.887 Test Loss: 0.353 Test Acc: 0.892
Validation loss decreased (inf --> -0.891973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3422471
	speed: 0.2110s/iter; left time: 3561.4629s
	iters: 200, epoch: 2 | loss: 0.3928095
	speed: 0.0383s/iter; left time: 642.2176s
	iters: 300, epoch: 2 | loss: 0.4171805
	speed: 0.0415s/iter; left time: 692.3049s
	iters: 400, epoch: 2 | loss: 0.1660533
	speed: 0.0402s/iter; left time: 666.5783s
	iters: 500, epoch: 2 | loss: 0.2778506
	speed: 0.0420s/iter; left time: 692.4185s
	iters: 600, epoch: 2 | loss: 0.1592644
	speed: 0.0385s/iter; left time: 629.6254s
	iters: 700, epoch: 2 | loss: 0.0896856
	speed: 0.0390s/iter; left time: 634.3196s
	iters: 800, epoch: 2 | loss: 0.4634803
	speed: 0.0375s/iter; left time: 607.2052s
	iters: 900, epoch: 2 | loss: 0.1729662
	speed: 0.0433s/iter; left time: 696.2458s
	iters: 1000, epoch: 2 | loss: 0.0845614
	speed: 0.0457s/iter; left time: 729.3210s
	iters: 1100, epoch: 2 | loss: 0.0427266
	speed: 0.0485s/iter; left time: 769.9235s
	iters: 1200, epoch: 2 | loss: 0.0199213
	speed: 0.0476s/iter; left time: 750.6340s
	iters: 1300, epoch: 2 | loss: 0.2827322
	speed: 0.0443s/iter; left time: 694.0166s
	iters: 1400, epoch: 2 | loss: 0.1961543
	speed: 0.0457s/iter; left time: 711.6203s
	iters: 1500, epoch: 2 | loss: 0.4308159
	speed: 0.0508s/iter; left time: 786.6041s
	iters: 1600, epoch: 2 | loss: 0.1467244
	speed: 0.0458s/iter; left time: 703.5148s
	iters: 1700, epoch: 2 | loss: 0.4386567
	speed: 0.0390s/iter; left time: 595.8313s
	iters: 1800, epoch: 2 | loss: 0.0808347
	speed: 0.0411s/iter; left time: 623.3230s
Epoch: 2 cost time: 80.77039122581482
Epoch: 2, Steps: 1886 | Train Loss: 0.271 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.891973 --> -0.950508).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0663934
	speed: 0.2238s/iter; left time: 3354.7302s
	iters: 200, epoch: 3 | loss: 0.0900806
	speed: 0.0438s/iter; left time: 652.3412s
	iters: 300, epoch: 3 | loss: 0.5077989
	speed: 0.0433s/iter; left time: 640.9639s
	iters: 400, epoch: 3 | loss: 0.0146338
	speed: 0.0444s/iter; left time: 652.7524s
	iters: 500, epoch: 3 | loss: 0.0263740
	speed: 0.0496s/iter; left time: 723.0020s
	iters: 600, epoch: 3 | loss: 0.2930745
	speed: 0.0424s/iter; left time: 614.6259s
	iters: 700, epoch: 3 | loss: 0.0064683
	speed: 0.0463s/iter; left time: 665.7725s
	iters: 800, epoch: 3 | loss: 0.0942907
	speed: 0.0376s/iter; left time: 536.9272s
	iters: 900, epoch: 3 | loss: 0.0253056
	speed: 0.0402s/iter; left time: 570.4166s
	iters: 1000, epoch: 3 | loss: 0.8512068
	speed: 0.0459s/iter; left time: 647.0071s
	iters: 1100, epoch: 3 | loss: 0.0755850
	speed: 0.0480s/iter; left time: 671.0175s
	iters: 1200, epoch: 3 | loss: 0.0217266
	speed: 0.0429s/iter; left time: 596.2137s
	iters: 1300, epoch: 3 | loss: 0.6590556
	speed: 0.0433s/iter; left time: 596.6153s
	iters: 1400, epoch: 3 | loss: 0.0073817
	speed: 0.0370s/iter; left time: 505.8089s
	iters: 1500, epoch: 3 | loss: 0.0215019
	speed: 0.0377s/iter; left time: 512.0482s
	iters: 1600, epoch: 3 | loss: 0.4671424
	speed: 0.0377s/iter; left time: 508.1551s
	iters: 1700, epoch: 3 | loss: 0.4218842
	speed: 0.0417s/iter; left time: 558.9866s
	iters: 1800, epoch: 3 | loss: 0.0440785
	speed: 0.0425s/iter; left time: 565.0640s
Epoch: 3 cost time: 81.14333605766296
Epoch: 3, Steps: 1886 | Train Loss: 0.164 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.950508 --> -0.963991).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0852013
	speed: 0.2103s/iter; left time: 2756.1501s
	iters: 200, epoch: 4 | loss: 0.1052610
	speed: 0.0457s/iter; left time: 593.7485s
	iters: 300, epoch: 4 | loss: 0.0075783
	speed: 0.0474s/iter; left time: 611.9523s
	iters: 400, epoch: 4 | loss: 0.0109555
	speed: 0.0459s/iter; left time: 587.2629s
	iters: 500, epoch: 4 | loss: 0.0044847
	speed: 0.0490s/iter; left time: 622.9845s
	iters: 600, epoch: 4 | loss: 0.3964037
	speed: 0.0464s/iter; left time: 585.1203s
	iters: 700, epoch: 4 | loss: 0.0991780
	speed: 0.0487s/iter; left time: 609.0562s
	iters: 800, epoch: 4 | loss: 0.0359610
	speed: 0.0481s/iter; left time: 597.0421s
	iters: 900, epoch: 4 | loss: 0.0542534
	speed: 0.0479s/iter; left time: 589.3747s
	iters: 1000, epoch: 4 | loss: 0.0860124
	speed: 0.0465s/iter; left time: 566.9378s
	iters: 1100, epoch: 4 | loss: 0.0930355
	speed: 0.0468s/iter; left time: 566.0717s
	iters: 1200, epoch: 4 | loss: 0.0566104
	speed: 0.0515s/iter; left time: 617.6351s
	iters: 1300, epoch: 4 | loss: 0.0181517
	speed: 0.0474s/iter; left time: 563.8490s
	iters: 1400, epoch: 4 | loss: 0.1778937
	speed: 0.0449s/iter; left time: 530.1307s
	iters: 1500, epoch: 4 | loss: 0.0282221
	speed: 0.0519s/iter; left time: 607.1822s
	iters: 1600, epoch: 4 | loss: 0.1822635
	speed: 0.0547s/iter; left time: 634.4580s
	iters: 1700, epoch: 4 | loss: 0.2861094
	speed: 0.0487s/iter; left time: 560.5373s
	iters: 1800, epoch: 4 | loss: 0.3500755
	speed: 0.0478s/iter; left time: 545.3399s
Epoch: 4 cost time: 90.87998962402344
Epoch: 4, Steps: 1886 | Train Loss: 0.122 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.966
Validation loss decreased (-0.963991 --> -0.966371).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1141893
	speed: 0.2179s/iter; left time: 2444.3086s
	iters: 200, epoch: 5 | loss: 0.0169103
	speed: 0.0465s/iter; left time: 517.1615s
	iters: 300, epoch: 5 | loss: 0.2266936
	speed: 0.0512s/iter; left time: 564.5933s
	iters: 400, epoch: 5 | loss: 0.0260224
	speed: 0.0438s/iter; left time: 478.0936s
	iters: 500, epoch: 5 | loss: 0.0046758
	speed: 0.0423s/iter; left time: 457.3558s
	iters: 600, epoch: 5 | loss: 0.0516569
	speed: 0.0375s/iter; left time: 401.8755s
	iters: 700, epoch: 5 | loss: 0.1555841
	speed: 0.0381s/iter; left time: 404.1487s
	iters: 800, epoch: 5 | loss: 0.0024644
	speed: 0.0386s/iter; left time: 405.8068s
	iters: 900, epoch: 5 | loss: 0.3845523
	speed: 0.0406s/iter; left time: 422.9416s
	iters: 1000, epoch: 5 | loss: 0.0631362
	speed: 0.0438s/iter; left time: 451.6821s
	iters: 1100, epoch: 5 | loss: 0.1513702
	speed: 0.0364s/iter; left time: 371.5163s
	iters: 1200, epoch: 5 | loss: 0.4313650
	speed: 0.0426s/iter; left time: 431.1705s
	iters: 1300, epoch: 5 | loss: 0.0073165
	speed: 0.0421s/iter; left time: 421.8123s
	iters: 1400, epoch: 5 | loss: 0.3318734
	speed: 0.0387s/iter; left time: 383.7321s
	iters: 1500, epoch: 5 | loss: 0.0184040
	speed: 0.0366s/iter; left time: 359.3021s
	iters: 1600, epoch: 5 | loss: 0.0355084
	speed: 0.0363s/iter; left time: 352.9398s
	iters: 1700, epoch: 5 | loss: 0.0057155
	speed: 0.0343s/iter; left time: 330.0783s
	iters: 1800, epoch: 5 | loss: 0.0208802
	speed: 0.0370s/iter; left time: 352.5649s
Epoch: 5 cost time: 76.60270428657532
Epoch: 5, Steps: 1886 | Train Loss: 0.095 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.966371 --> -0.968274).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1096195
	speed: 0.2082s/iter; left time: 1943.0606s
	iters: 200, epoch: 6 | loss: 0.0032942
	speed: 0.0374s/iter; left time: 345.4114s
	iters: 300, epoch: 6 | loss: 0.6840028
	speed: 0.0343s/iter; left time: 313.3825s
	iters: 400, epoch: 6 | loss: 0.0268260
	speed: 0.0457s/iter; left time: 412.4700s
	iters: 500, epoch: 6 | loss: 0.0036324
	speed: 0.0355s/iter; left time: 317.2701s
	iters: 600, epoch: 6 | loss: 0.0008210
	speed: 0.0330s/iter; left time: 291.5741s
	iters: 700, epoch: 6 | loss: 0.1074174
	speed: 0.0347s/iter; left time: 302.5904s
	iters: 800, epoch: 6 | loss: 0.0108686
	speed: 0.0360s/iter; left time: 310.3052s
	iters: 900, epoch: 6 | loss: 0.0518429
	speed: 0.0398s/iter; left time: 339.2418s
	iters: 1000, epoch: 6 | loss: 0.0078560
	speed: 0.0360s/iter; left time: 303.6524s
	iters: 1100, epoch: 6 | loss: 0.1147533
	speed: 0.0413s/iter; left time: 344.3784s
	iters: 1200, epoch: 6 | loss: 0.2160395
	speed: 0.0428s/iter; left time: 352.6662s
	iters: 1300, epoch: 6 | loss: 0.0076851
	speed: 0.0427s/iter; left time: 347.5363s
	iters: 1400, epoch: 6 | loss: 0.0066604
	speed: 0.0434s/iter; left time: 348.7390s
	iters: 1500, epoch: 6 | loss: 0.3607654
	speed: 0.0411s/iter; left time: 325.7483s
	iters: 1600, epoch: 6 | loss: 0.0043386
	speed: 0.0439s/iter; left time: 343.4735s
	iters: 1700, epoch: 6 | loss: 0.0192860
	speed: 0.0468s/iter; left time: 361.4488s
	iters: 1800, epoch: 6 | loss: 0.0650535
	speed: 0.0423s/iter; left time: 322.8716s
Epoch: 6 cost time: 75.2081310749054
Epoch: 6, Steps: 1886 | Train Loss: 0.077 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1325410
	speed: 0.2187s/iter; left time: 1628.1263s
	iters: 200, epoch: 7 | loss: 0.0043355
	speed: 0.0536s/iter; left time: 393.3940s
	iters: 300, epoch: 7 | loss: 0.0100213
	speed: 0.0479s/iter; left time: 347.2509s
	iters: 400, epoch: 7 | loss: 0.0344562
	speed: 0.0481s/iter; left time: 343.9095s
	iters: 500, epoch: 7 | loss: 0.4608652
	speed: 0.0396s/iter; left time: 278.6504s
	iters: 600, epoch: 7 | loss: 0.0022860
	speed: 0.0441s/iter; left time: 306.2016s
	iters: 700, epoch: 7 | loss: 0.0025338
	speed: 0.0392s/iter; left time: 268.2529s
	iters: 800, epoch: 7 | loss: 0.0169371
	speed: 0.0395s/iter; left time: 266.5396s
	iters: 900, epoch: 7 | loss: 0.0021968
	speed: 0.0388s/iter; left time: 257.5644s
	iters: 1000, epoch: 7 | loss: 0.0001983
	speed: 0.0403s/iter; left time: 263.8015s
	iters: 1100, epoch: 7 | loss: 0.0044297
	speed: 0.0437s/iter; left time: 281.5141s
	iters: 1200, epoch: 7 | loss: 0.0310354
	speed: 0.0378s/iter; left time: 239.6569s
	iters: 1300, epoch: 7 | loss: 0.0841209
	speed: 0.0373s/iter; left time: 232.9944s
	iters: 1400, epoch: 7 | loss: 0.0036894
	speed: 0.0433s/iter; left time: 266.1266s
	iters: 1500, epoch: 7 | loss: 0.0028937
	speed: 0.0352s/iter; left time: 212.6531s
	iters: 1600, epoch: 7 | loss: 0.0054647
	speed: 0.0352s/iter; left time: 209.4057s
	iters: 1700, epoch: 7 | loss: 0.0041628
	speed: 0.0341s/iter; left time: 199.4654s
	iters: 1800, epoch: 7 | loss: 0.0240832
	speed: 0.0360s/iter; left time: 206.9080s
Epoch: 7 cost time: 77.8610610961914
Epoch: 7, Steps: 1886 | Train Loss: 0.062 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.968274 --> -0.972398).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0020353
	speed: 0.2110s/iter; left time: 1173.0836s
	iters: 200, epoch: 8 | loss: 0.1292628
	speed: 0.0467s/iter; left time: 254.9458s
	iters: 300, epoch: 8 | loss: 0.0211004
	speed: 0.0404s/iter; left time: 216.6855s
	iters: 400, epoch: 8 | loss: 0.0005595
	speed: 0.0435s/iter; left time: 228.5776s
	iters: 500, epoch: 8 | loss: 0.0136963
	speed: 0.0377s/iter; left time: 194.2414s
	iters: 600, epoch: 8 | loss: 0.0005757
	speed: 0.0425s/iter; left time: 215.1813s
	iters: 700, epoch: 8 | loss: 0.0040182
	speed: 0.0400s/iter; left time: 198.2449s
	iters: 800, epoch: 8 | loss: 0.0002003
	speed: 0.0356s/iter; left time: 173.1631s
	iters: 900, epoch: 8 | loss: 0.0049045
	speed: 0.0369s/iter; left time: 175.8102s
	iters: 1000, epoch: 8 | loss: 0.0010148
	speed: 0.0409s/iter; left time: 190.4120s
	iters: 1100, epoch: 8 | loss: 0.0208042
	speed: 0.0395s/iter; left time: 180.1807s
	iters: 1200, epoch: 8 | loss: 0.0072489
	speed: 0.0438s/iter; left time: 195.0926s
	iters: 1300, epoch: 8 | loss: 0.0000742
	speed: 0.0403s/iter; left time: 175.4527s
	iters: 1400, epoch: 8 | loss: 0.0222339
	speed: 0.0465s/iter; left time: 198.1826s
	iters: 1500, epoch: 8 | loss: 0.0001188
	speed: 0.0460s/iter; left time: 191.4657s
	iters: 1600, epoch: 8 | loss: 0.0240485
	speed: 0.0491s/iter; left time: 199.3368s
	iters: 1700, epoch: 8 | loss: 0.1942629
	speed: 0.0375s/iter; left time: 148.6339s
	iters: 1800, epoch: 8 | loss: 0.0116860
	speed: 0.0417s/iter; left time: 161.0760s
Epoch: 8 cost time: 79.3923282623291
Epoch: 8, Steps: 1886 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.972398 --> -0.972557).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0016801
	speed: 0.2119s/iter; left time: 778.2664s
	iters: 200, epoch: 9 | loss: 0.0005636
	speed: 0.0464s/iter; left time: 165.7120s
	iters: 300, epoch: 9 | loss: 0.0032448
	speed: 0.0497s/iter; left time: 172.5642s
	iters: 400, epoch: 9 | loss: 0.1370406
	speed: 0.0450s/iter; left time: 151.6241s
	iters: 500, epoch: 9 | loss: 0.2222109
	speed: 0.0462s/iter; left time: 151.2126s
	iters: 600, epoch: 9 | loss: 0.0002560
	speed: 0.0458s/iter; left time: 145.4201s
	iters: 700, epoch: 9 | loss: 0.1012213
	speed: 0.0445s/iter; left time: 136.6472s
	iters: 800, epoch: 9 | loss: 0.0001426
	speed: 0.0401s/iter; left time: 119.2519s
	iters: 900, epoch: 9 | loss: 0.0004799
	speed: 0.0387s/iter; left time: 111.0506s
	iters: 1000, epoch: 9 | loss: 0.0004427
	speed: 0.0429s/iter; left time: 119.0597s
	iters: 1100, epoch: 9 | loss: 0.2514951
	speed: 0.0469s/iter; left time: 125.2325s
	iters: 1200, epoch: 9 | loss: 0.0079602
	speed: 0.0506s/iter; left time: 130.1363s
	iters: 1300, epoch: 9 | loss: 0.0252043
	speed: 0.0457s/iter; left time: 113.0360s
	iters: 1400, epoch: 9 | loss: 0.0113850
	speed: 0.0352s/iter; left time: 83.4902s
	iters: 1500, epoch: 9 | loss: 0.0008746
	speed: 0.0329s/iter; left time: 74.8114s
	iters: 1600, epoch: 9 | loss: 0.0007101
	speed: 0.0395s/iter; left time: 85.8707s
	iters: 1700, epoch: 9 | loss: 0.0017216
	speed: 0.0366s/iter; left time: 75.7689s
	iters: 1800, epoch: 9 | loss: 0.0000490
	speed: 0.0392s/iter; left time: 77.2940s
Epoch: 9 cost time: 81.01644277572632
Epoch: 9, Steps: 1886 | Train Loss: 0.042 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0117182
	speed: 0.2171s/iter; left time: 387.9584s
	iters: 200, epoch: 10 | loss: 0.0011036
	speed: 0.0465s/iter; left time: 78.3663s
	iters: 300, epoch: 10 | loss: 0.4700797
	speed: 0.0430s/iter; left time: 68.2004s
	iters: 400, epoch: 10 | loss: 0.0000721
	speed: 0.0448s/iter; left time: 66.5651s
	iters: 500, epoch: 10 | loss: 0.0001069
	speed: 0.0476s/iter; left time: 66.0168s
	iters: 600, epoch: 10 | loss: 0.2535568
	speed: 0.0456s/iter; left time: 58.7020s
	iters: 700, epoch: 10 | loss: 0.0017781
	speed: 0.0497s/iter; left time: 58.9683s
	iters: 800, epoch: 10 | loss: 0.0657296
	speed: 0.0429s/iter; left time: 46.6572s
	iters: 900, epoch: 10 | loss: 0.0007325
	speed: 0.0314s/iter; left time: 30.9497s
	iters: 1000, epoch: 10 | loss: 0.0699624
	speed: 0.0334s/iter; left time: 29.6693s
	iters: 1100, epoch: 10 | loss: 0.0000124
	speed: 0.0369s/iter; left time: 29.0556s
	iters: 1200, epoch: 10 | loss: 0.0232442
	speed: 0.0327s/iter; left time: 22.4333s
	iters: 1300, epoch: 10 | loss: 0.0034185
	speed: 0.0316s/iter; left time: 18.5322s
	iters: 1400, epoch: 10 | loss: 0.0046268
	speed: 0.0336s/iter; left time: 16.3630s
	iters: 1500, epoch: 10 | loss: 0.0025045
	speed: 0.0323s/iter; left time: 12.4949s
	iters: 1600, epoch: 10 | loss: 0.0261851
	speed: 0.0317s/iter; left time: 9.1056s
	iters: 1700, epoch: 10 | loss: 0.0745892
	speed: 0.0316s/iter; left time: 5.9125s
	iters: 1800, epoch: 10 | loss: 0.1428273
	speed: 0.0333s/iter; left time: 2.8996s
Epoch: 10 cost time: 72.47785687446594
Epoch: 10, Steps: 1886 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_classification_vpn-vnat-m.csv_none_TimeMixer_custom_sl192_pl0_dm128_nh8_el5_dl2_df256_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test shape: torch.Size([6304, 5]) torch.Size([6304])
accuracy:0.9725571065989848, precision:0.9718387579266379, recall:0.9725571065989848, f1:0.9719921560543936
Args in experiment:
Namespace(task_name='classification', is_training=1, model_id='classification_vpn-vnat-m.csv', model='TimeMixer', data='custom', root_path='./dataset/', data_path='vpn-vnat-m.csv', features='MS', target='Label', freq='h', checkpoints='./checkpoints/', seq_len=384, label_len=0, pred_len=0, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=76, dec_in=76, c_out=1, d_model=128, n_heads=8, e_layers=5, d_layers=2, d_ff=256, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=0, decomp_method='moving_avg', use_norm=0, down_sampling_layers=1, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.25, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=10, batch_size=16, patience=10, learning_rate=0.003, des='Exp', loss='MSE', lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
train 29997
val 6127
test 6127
>>>>>>>start training : classification_classification_vpn-vnat-m.csv_none_TimeMixer_custom_sl384_pl0_dm128_nh8_el5_dl2_df256_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 100, epoch: 1 | loss: 1.0540431
	speed: 0.1012s/iter; left time: 1887.1852s
	iters: 200, epoch: 1 | loss: 1.2012457
	speed: 0.0573s/iter; left time: 1063.1343s
	iters: 300, epoch: 1 | loss: 1.1069915
	speed: 0.0552s/iter; left time: 1017.3836s
	iters: 400, epoch: 1 | loss: 1.4977592
	speed: 0.0503s/iter; left time: 922.5792s
	iters: 500, epoch: 1 | loss: 1.2927209
	speed: 0.0481s/iter; left time: 877.2931s
	iters: 600, epoch: 1 | loss: 1.0030390
	speed: 0.0477s/iter; left time: 865.6116s
	iters: 700, epoch: 1 | loss: 0.9362772
	speed: 0.0531s/iter; left time: 957.8290s
	iters: 800, epoch: 1 | loss: 0.8860875
	speed: 0.0514s/iter; left time: 921.7553s
	iters: 900, epoch: 1 | loss: 0.8343342
	speed: 0.0522s/iter; left time: 931.2456s
	iters: 1000, epoch: 1 | loss: 0.7505244
	speed: 0.0501s/iter; left time: 889.1424s
	iters: 1100, epoch: 1 | loss: 0.6777772
	speed: 0.0497s/iter; left time: 876.7968s
	iters: 1200, epoch: 1 | loss: 0.5899127
	speed: 0.0550s/iter; left time: 964.8357s
	iters: 1300, epoch: 1 | loss: 1.4487717
	speed: 0.0511s/iter; left time: 891.1566s
	iters: 1400, epoch: 1 | loss: 0.8476251
	speed: 0.0508s/iter; left time: 881.1152s
	iters: 1500, epoch: 1 | loss: 0.1274210
	speed: 0.0524s/iter; left time: 904.2025s
	iters: 1600, epoch: 1 | loss: 0.7459140
	speed: 0.0491s/iter; left time: 841.6969s
	iters: 1700, epoch: 1 | loss: 0.3282231
	speed: 0.0513s/iter; left time: 874.3644s
	iters: 1800, epoch: 1 | loss: 0.2283585
	speed: 0.0528s/iter; left time: 894.9068s
Epoch: 1 cost time: 98.09670758247375
Epoch: 1, Steps: 1874 | Train Loss: 0.908 Vali Loss: 0.349 Vali Acc: 0.888 Test Loss: 0.325 Test Acc: 0.891
Validation loss decreased (inf --> -0.891198).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1868346
	speed: 0.2263s/iter; left time: 3793.9785s
	iters: 200, epoch: 2 | loss: 0.3962987
	speed: 0.0540s/iter; left time: 900.7683s
	iters: 300, epoch: 2 | loss: 0.3299234
	speed: 0.0518s/iter; left time: 858.2035s
	iters: 400, epoch: 2 | loss: 0.1941306
	speed: 0.0474s/iter; left time: 780.2614s
	iters: 500, epoch: 2 | loss: 0.2793154
	speed: 0.0433s/iter; left time: 708.3694s
	iters: 600, epoch: 2 | loss: 0.0921107
	speed: 0.0387s/iter; left time: 629.8520s
	iters: 700, epoch: 2 | loss: 0.2431799
	speed: 0.0429s/iter; left time: 693.7129s
	iters: 800, epoch: 2 | loss: 1.0524446
	speed: 0.0372s/iter; left time: 597.9541s
	iters: 900, epoch: 2 | loss: 0.6520204
	speed: 0.0408s/iter; left time: 652.1780s
	iters: 1000, epoch: 2 | loss: 0.1576941
	speed: 0.0422s/iter; left time: 670.2420s
	iters: 1100, epoch: 2 | loss: 0.2748757
	speed: 0.0354s/iter; left time: 557.3676s
	iters: 1200, epoch: 2 | loss: 0.3103105
	speed: 0.0343s/iter; left time: 537.4629s
	iters: 1300, epoch: 2 | loss: 0.2501930
	speed: 0.0335s/iter; left time: 521.0151s
	iters: 1400, epoch: 2 | loss: 0.0561402
	speed: 0.0351s/iter; left time: 543.1710s
	iters: 1500, epoch: 2 | loss: 0.2402329
	speed: 0.0402s/iter; left time: 617.5234s
	iters: 1600, epoch: 2 | loss: 0.3797089
	speed: 0.0407s/iter; left time: 621.8799s
	iters: 1700, epoch: 2 | loss: 0.2051986
	speed: 0.0354s/iter; left time: 537.6165s
	iters: 1800, epoch: 2 | loss: 0.1056276
	speed: 0.0466s/iter; left time: 702.8741s
Epoch: 2 cost time: 79.42770957946777
Epoch: 2, Steps: 1874 | Train Loss: 0.282 Vali Loss: 0.199 Vali Acc: 0.942 Test Loss: 0.185 Test Acc: 0.943
Validation loss decreased (-0.891198 --> -0.942572).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1852622
	speed: 0.2170s/iter; left time: 3231.5652s
	iters: 200, epoch: 3 | loss: 0.0253092
	speed: 0.0465s/iter; left time: 688.2633s
	iters: 300, epoch: 3 | loss: 0.3766088
	speed: 0.0537s/iter; left time: 788.7154s
	iters: 400, epoch: 3 | loss: 1.1297863
	speed: 0.0499s/iter; left time: 728.6594s
	iters: 500, epoch: 3 | loss: 0.1233256
	speed: 0.0506s/iter; left time: 733.4235s
	iters: 600, epoch: 3 | loss: 0.1956099
	speed: 0.0500s/iter; left time: 719.8144s
	iters: 700, epoch: 3 | loss: 0.0159347
	speed: 0.0533s/iter; left time: 761.5355s
	iters: 800, epoch: 3 | loss: 0.0255977
	speed: 0.0478s/iter; left time: 678.1087s
	iters: 900, epoch: 3 | loss: 0.1023658
	speed: 0.0424s/iter; left time: 597.4635s
	iters: 1000, epoch: 3 | loss: 0.0316258
	speed: 0.0456s/iter; left time: 637.6689s
	iters: 1100, epoch: 3 | loss: 0.0657824
	speed: 0.0481s/iter; left time: 668.4870s
	iters: 1200, epoch: 3 | loss: 0.0544918
	speed: 0.0485s/iter; left time: 668.3451s
	iters: 1300, epoch: 3 | loss: 0.0196363
	speed: 0.0419s/iter; left time: 573.0623s
	iters: 1400, epoch: 3 | loss: 0.2186527
	speed: 0.0478s/iter; left time: 649.6910s
	iters: 1500, epoch: 3 | loss: 0.3072649
	speed: 0.0467s/iter; left time: 629.5103s
	iters: 1600, epoch: 3 | loss: 0.2405297
	speed: 0.0455s/iter; left time: 608.8476s
	iters: 1700, epoch: 3 | loss: 0.3312525
	speed: 0.0494s/iter; left time: 657.0596s
	iters: 1800, epoch: 3 | loss: 0.3929372
	speed: 0.0516s/iter; left time: 681.0159s
Epoch: 3 cost time: 90.49123024940491
Epoch: 3, Steps: 1874 | Train Loss: 0.183 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.132 Test Acc: 0.960
Validation loss decreased (-0.942572 --> -0.959751).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0284280
	speed: 0.2263s/iter; left time: 2946.1355s
	iters: 200, epoch: 4 | loss: 0.3792326
	speed: 0.0544s/iter; left time: 702.7727s
	iters: 300, epoch: 4 | loss: 0.0086527
	speed: 0.0530s/iter; left time: 679.2099s
	iters: 400, epoch: 4 | loss: 0.0644254
	speed: 0.0490s/iter; left time: 622.7642s
	iters: 500, epoch: 4 | loss: 0.1324567
	speed: 0.0507s/iter; left time: 639.4711s
	iters: 600, epoch: 4 | loss: 0.5602193
	speed: 0.0439s/iter; left time: 550.1302s
	iters: 700, epoch: 4 | loss: 0.1492543
	speed: 0.0422s/iter; left time: 523.8926s
	iters: 800, epoch: 4 | loss: 0.2254879
	speed: 0.0478s/iter; left time: 588.9370s
	iters: 900, epoch: 4 | loss: 0.1366926
	speed: 0.0457s/iter; left time: 557.9955s
	iters: 1000, epoch: 4 | loss: 0.0517227
	speed: 0.0422s/iter; left time: 511.5357s
	iters: 1100, epoch: 4 | loss: 0.1599139
	speed: 0.0442s/iter; left time: 531.7319s
	iters: 1200, epoch: 4 | loss: 0.1751399
	speed: 0.0449s/iter; left time: 535.7315s
	iters: 1300, epoch: 4 | loss: 0.0076669
	speed: 0.0454s/iter; left time: 536.1216s
	iters: 1400, epoch: 4 | loss: 0.0268346
	speed: 0.0459s/iter; left time: 537.8592s
	iters: 1500, epoch: 4 | loss: 0.2471503
	speed: 0.0360s/iter; left time: 418.2753s
	iters: 1600, epoch: 4 | loss: 0.0225437
	speed: 0.0355s/iter; left time: 408.5132s
	iters: 1700, epoch: 4 | loss: 0.0242430
	speed: 0.0376s/iter; left time: 429.7285s
	iters: 1800, epoch: 4 | loss: 0.3290628
	speed: 0.0363s/iter; left time: 410.7412s
Epoch: 4 cost time: 84.11099767684937
Epoch: 4, Steps: 1874 | Train Loss: 0.133 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.959751 --> -0.965151).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1057274
	speed: 0.2165s/iter; left time: 2412.9348s
	iters: 200, epoch: 5 | loss: 0.0506049
	speed: 0.0555s/iter; left time: 613.3429s
	iters: 300, epoch: 5 | loss: 0.0679392
	speed: 0.0382s/iter; left time: 418.2642s
	iters: 400, epoch: 5 | loss: 0.0184775
	speed: 0.0350s/iter; left time: 379.7819s
	iters: 500, epoch: 5 | loss: 0.1571914
	speed: 0.0473s/iter; left time: 508.7278s
	iters: 600, epoch: 5 | loss: 0.0004011
	speed: 0.0516s/iter; left time: 549.5170s
	iters: 700, epoch: 5 | loss: 0.0014321
	speed: 0.0483s/iter; left time: 508.8961s
	iters: 800, epoch: 5 | loss: 0.0150801
	speed: 0.0488s/iter; left time: 510.0645s
	iters: 900, epoch: 5 | loss: 0.0075044
	speed: 0.0482s/iter; left time: 498.2570s
	iters: 1000, epoch: 5 | loss: 0.2196077
	speed: 0.0568s/iter; left time: 582.0838s
	iters: 1100, epoch: 5 | loss: 0.1835268
	speed: 0.0489s/iter; left time: 496.1629s
	iters: 1200, epoch: 5 | loss: 0.0164989
	speed: 0.0348s/iter; left time: 349.4109s
	iters: 1300, epoch: 5 | loss: 0.0725717
	speed: 0.0344s/iter; left time: 342.2809s
	iters: 1400, epoch: 5 | loss: 0.1383391
	speed: 0.0351s/iter; left time: 345.5631s
	iters: 1500, epoch: 5 | loss: 0.2715813
	speed: 0.0354s/iter; left time: 344.8338s
	iters: 1600, epoch: 5 | loss: 0.4586664
	speed: 0.0364s/iter; left time: 350.6807s
	iters: 1700, epoch: 5 | loss: 0.0026696
	speed: 0.0369s/iter; left time: 352.5900s
	iters: 1800, epoch: 5 | loss: 0.0305845
	speed: 0.0345s/iter; left time: 325.5316s
Epoch: 5 cost time: 80.68271613121033
Epoch: 5, Steps: 1874 | Train Loss: 0.111 Vali Loss: 0.127 Vali Acc: 0.961 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.965151 --> -0.966950).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2195235
	speed: 0.2225s/iter; left time: 2062.4365s
	iters: 200, epoch: 6 | loss: 0.2805881
	speed: 0.0567s/iter; left time: 520.1355s
	iters: 300, epoch: 6 | loss: 0.0156222
	speed: 0.0504s/iter; left time: 457.3339s
	iters: 400, epoch: 6 | loss: 0.0189442
	speed: 0.0486s/iter; left time: 436.2139s
	iters: 500, epoch: 6 | loss: 0.0373834
	speed: 0.0503s/iter; left time: 446.1249s
	iters: 600, epoch: 6 | loss: 0.1589984
	speed: 0.0479s/iter; left time: 420.2282s
	iters: 700, epoch: 6 | loss: 0.2402930
	speed: 0.0445s/iter; left time: 386.2791s
	iters: 800, epoch: 6 | loss: 0.0014452
	speed: 0.0481s/iter; left time: 412.1847s
	iters: 900, epoch: 6 | loss: 0.0091885
	speed: 0.0502s/iter; left time: 425.0925s
	iters: 1000, epoch: 6 | loss: 0.5102664
	speed: 0.0526s/iter; left time: 440.4601s
	iters: 1100, epoch: 6 | loss: 0.0457765
	speed: 0.0537s/iter; left time: 443.8520s
	iters: 1200, epoch: 6 | loss: 0.0308501
	speed: 0.0495s/iter; left time: 404.3253s
	iters: 1300, epoch: 6 | loss: 0.0084419
	speed: 0.0490s/iter; left time: 395.3979s
	iters: 1400, epoch: 6 | loss: 0.0065537
	speed: 0.0479s/iter; left time: 381.7091s
	iters: 1500, epoch: 6 | loss: 0.0038702
	speed: 0.0520s/iter; left time: 409.1051s
	iters: 1600, epoch: 6 | loss: 0.2054058
	speed: 0.0546s/iter; left time: 424.6787s
	iters: 1700, epoch: 6 | loss: 0.0166589
	speed: 0.0491s/iter; left time: 376.9760s
	iters: 1800, epoch: 6 | loss: 0.2261277
	speed: 0.0474s/iter; left time: 358.7031s
Epoch: 6 cost time: 95.29672718048096
Epoch: 6, Steps: 1874 | Train Loss: 0.088 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0173933
	speed: 0.2309s/iter; left time: 1708.2419s
	iters: 200, epoch: 7 | loss: 0.0183138
	speed: 0.0368s/iter; left time: 268.7494s
	iters: 300, epoch: 7 | loss: 0.0070268
	speed: 0.0443s/iter; left time: 319.0316s
	iters: 400, epoch: 7 | loss: 0.0061247
	speed: 0.0414s/iter; left time: 293.8373s
	iters: 500, epoch: 7 | loss: 0.0106434
	speed: 0.0339s/iter; left time: 237.3929s
	iters: 600, epoch: 7 | loss: 0.0069917
	speed: 0.0339s/iter; left time: 233.6052s
	iters: 700, epoch: 7 | loss: 0.0153335
	speed: 0.0359s/iter; left time: 243.7438s
	iters: 800, epoch: 7 | loss: 0.0008618
	speed: 0.0354s/iter; left time: 237.2398s
	iters: 900, epoch: 7 | loss: 0.0447837
	speed: 0.0357s/iter; left time: 235.4492s
	iters: 1000, epoch: 7 | loss: 0.1260415
	speed: 0.0358s/iter; left time: 232.8348s
	iters: 1100, epoch: 7 | loss: 0.0134710
	speed: 0.0357s/iter; left time: 228.2936s
	iters: 1200, epoch: 7 | loss: 0.3794068
	speed: 0.0369s/iter; left time: 232.6678s
	iters: 1300, epoch: 7 | loss: 0.1076143
	speed: 0.0395s/iter; left time: 244.7226s
	iters: 1400, epoch: 7 | loss: 0.0012247
	speed: 0.0385s/iter; left time: 234.6595s
	iters: 1500, epoch: 7 | loss: 0.0130315
	speed: 0.0381s/iter; left time: 228.3351s
	iters: 1600, epoch: 7 | loss: 0.0701457
	speed: 0.0354s/iter; left time: 208.7268s
	iters: 1700, epoch: 7 | loss: 0.0031985
	speed: 0.0415s/iter; left time: 240.3063s
	iters: 1800, epoch: 7 | loss: 0.0020314
	speed: 0.0502s/iter; left time: 286.2669s
Epoch: 7 cost time: 74.34185481071472
Epoch: 7, Steps: 1874 | Train Loss: 0.069 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0061878
	speed: 0.2421s/iter; left time: 1337.2416s
	iters: 200, epoch: 8 | loss: 0.0074054
	speed: 0.0519s/iter; left time: 281.4787s
	iters: 300, epoch: 8 | loss: 0.0001778
	speed: 0.0515s/iter; left time: 274.0260s
	iters: 400, epoch: 8 | loss: 0.0096046
	speed: 0.0518s/iter; left time: 270.6012s
	iters: 500, epoch: 8 | loss: 0.0310873
	speed: 0.0538s/iter; left time: 275.5863s
	iters: 600, epoch: 8 | loss: 0.0037081
	speed: 0.0478s/iter; left time: 240.0073s
	iters: 700, epoch: 8 | loss: 0.0173321
	speed: 0.0349s/iter; left time: 171.9459s
	iters: 800, epoch: 8 | loss: 0.0034949
	speed: 0.0499s/iter; left time: 240.5881s
	iters: 900, epoch: 8 | loss: 0.0077380
	speed: 0.0457s/iter; left time: 215.9522s
	iters: 1000, epoch: 8 | loss: 0.0001646
	speed: 0.0525s/iter; left time: 242.7970s
	iters: 1100, epoch: 8 | loss: 0.0008522
	speed: 0.0448s/iter; left time: 202.6442s
	iters: 1200, epoch: 8 | loss: 0.0029571
	speed: 0.0401s/iter; left time: 177.3770s
	iters: 1300, epoch: 8 | loss: 0.1148721
	speed: 0.0354s/iter; left time: 152.9611s
	iters: 1400, epoch: 8 | loss: 0.0024295
	speed: 0.0358s/iter; left time: 150.9891s
	iters: 1500, epoch: 8 | loss: 0.0053148
	speed: 0.0364s/iter; left time: 149.8863s
	iters: 1600, epoch: 8 | loss: 0.0437263
	speed: 0.0385s/iter; left time: 154.9168s
	iters: 1700, epoch: 8 | loss: 0.0001279
	speed: 0.0359s/iter; left time: 141.0058s
	iters: 1800, epoch: 8 | loss: 0.0006495
	speed: 0.0337s/iter; left time: 128.9188s
Epoch: 8 cost time: 82.32462215423584
Epoch: 8, Steps: 1874 | Train Loss: 0.050 Vali Loss: 0.203 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0496228
	speed: 0.2133s/iter; left time: 778.3291s
	iters: 200, epoch: 9 | loss: 0.0002748
	speed: 0.0534s/iter; left time: 189.4453s
	iters: 300, epoch: 9 | loss: 0.0023689
	speed: 0.0537s/iter; left time: 185.0749s
	iters: 400, epoch: 9 | loss: 0.0002247
	speed: 0.0485s/iter; left time: 162.5483s
	iters: 500, epoch: 9 | loss: 0.0003687
	speed: 0.0466s/iter; left time: 151.5415s
	iters: 600, epoch: 9 | loss: 0.0020576
	speed: 0.0476s/iter; left time: 149.9275s
	iters: 700, epoch: 9 | loss: 0.0017353
	speed: 0.0545s/iter; left time: 166.0685s
	iters: 800, epoch: 9 | loss: 0.0069494
	speed: 0.0495s/iter; left time: 145.8726s
	iters: 900, epoch: 9 | loss: 0.0225828
	speed: 0.0515s/iter; left time: 146.5896s
	iters: 1000, epoch: 9 | loss: 0.0478542
	speed: 0.0529s/iter; left time: 145.3323s
	iters: 1100, epoch: 9 | loss: 0.0053119
	speed: 0.0521s/iter; left time: 137.8941s
	iters: 1200, epoch: 9 | loss: 0.0000245
	speed: 0.0503s/iter; left time: 128.1110s
	iters: 1300, epoch: 9 | loss: 0.0173488
	speed: 0.0484s/iter; left time: 118.5999s
	iters: 1400, epoch: 9 | loss: 0.0411543
	speed: 0.0508s/iter; left time: 119.3300s
	iters: 1500, epoch: 9 | loss: 0.0000858
	speed: 0.0550s/iter; left time: 123.7837s
	iters: 1600, epoch: 9 | loss: 0.0002804
	speed: 0.0504s/iter; left time: 108.4107s
	iters: 1700, epoch: 9 | loss: 0.4111665
	speed: 0.0498s/iter; left time: 101.9482s
	iters: 1800, epoch: 9 | loss: 0.0017517
	speed: 0.0475s/iter; left time: 92.4921s
Epoch: 9 cost time: 95.89931750297546
Epoch: 9, Steps: 1874 | Train Loss: 0.043 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0027846
	speed: 0.2340s/iter; left time: 415.2796s
	iters: 200, epoch: 10 | loss: 0.3101281
	speed: 0.0360s/iter; left time: 60.3810s
	iters: 300, epoch: 10 | loss: 0.0165900
	speed: 0.0421s/iter; left time: 66.3430s
	iters: 400, epoch: 10 | loss: 0.0009165
	speed: 0.0384s/iter; left time: 56.5934s
	iters: 500, epoch: 10 | loss: 0.0003395
	speed: 0.0383s/iter; left time: 52.6758s
	iters: 600, epoch: 10 | loss: 0.0020069
	speed: 0.0349s/iter; left time: 44.5531s
	iters: 700, epoch: 10 | loss: 0.0000999
	speed: 0.0390s/iter; left time: 45.8672s
	iters: 800, epoch: 10 | loss: 0.2216044
	speed: 0.0350s/iter; left time: 37.6664s
	iters: 900, epoch: 10 | loss: 0.0000581
	speed: 0.0343s/iter; left time: 33.4644s
	iters: 1000, epoch: 10 | loss: 0.0001245
	speed: 0.0342s/iter; left time: 29.9266s
	iters: 1100, epoch: 10 | loss: 0.0033282
	speed: 0.0359s/iter; left time: 27.8266s
	iters: 1200, epoch: 10 | loss: 0.0008444
	speed: 0.0392s/iter; left time: 26.4799s
	iters: 1300, epoch: 10 | loss: 0.0041530
	speed: 0.0368s/iter; left time: 21.1396s
	iters: 1400, epoch: 10 | loss: 0.1173866
	speed: 0.0382s/iter; left time: 18.1400s
	iters: 1500, epoch: 10 | loss: 0.0272276
	speed: 0.0419s/iter; left time: 15.6976s
	iters: 1600, epoch: 10 | loss: 0.0018505
	speed: 0.0423s/iter; left time: 11.6247s
	iters: 1700, epoch: 10 | loss: 0.1780255
	speed: 0.0401s/iter; left time: 7.0206s
	iters: 1800, epoch: 10 | loss: 0.0670139
	speed: 0.0413s/iter; left time: 3.0968s
Epoch: 10 cost time: 72.12741756439209
Epoch: 10, Steps: 1874 | Train Loss: 0.037 Vali Loss: 0.256 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_classification_vpn-vnat-m.csv_none_TimeMixer_custom_sl384_pl0_dm128_nh8_el5_dl2_df256_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test shape: torch.Size([6112, 5]) torch.Size([6112])
accuracy:0.9669502617801047, precision:0.9663759239647846, recall:0.9669502617801047, f1:0.9655197013692662
